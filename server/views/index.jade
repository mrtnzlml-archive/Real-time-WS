extends layout

block script
    script(src='http://code.jquery.com/jquery-1.7.2.min.js')
    script(src='http://localhost:3000/socket.io/socket.io.js')
    script(type='text/javascript').
        var socket = io.connect('ws://127.0.0.1:3000/');

        socket.on('connect', function(){
            socket.emit('register', 'SERVER');
        });

        socket.on('devices', function(data) {
            //console.log(data);
            $('li.dev').remove();
            $.each(data, function(key, value) {
                $('#devices').append('<li class=dev>' + key + ' (' + value + ')</li>');
            });
        });

        socket.on('message', function(data) {
            $('#message').html(data);
        });

        socket.on('error', function() { console.error(arguments) });

block content
    pre#message OFFLINE
    hr
    h3 Connected devices:
    pre
        ul#devices